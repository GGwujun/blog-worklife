<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-worklife/umi.3ec1f225.css" />
    <script>
      window.routerBase = "/blog-worklife";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>25｜图表库：想要生成动态图表，用Echarts就够了 - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-worklife/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>后端开发<ul><li><a href="/blog-worklife/大规模数据处理实战">大规模数据处理实战</a></li></ul></span><span>工作生活<ul><li><a href="/blog-worklife/10x程序员工作法">10x程序员工作法</a></li><li><a aria-current="page" class="active" href="/blog-worklife/python自动化办公实战课">python自动化办公实战课</a></li><li><a href="/blog-worklife/人人都用得上的写作课">人人都用得上的写作课</a></li><li><a href="/blog-worklife/体验设计案例课">体验设计案例课</a></li><li><a href="/blog-worklife/基于人因的用户体验设计课">基于人因的用户体验设计课</a></li><li><a href="/blog-worklife/打造爆款短视频">打造爆款短视频</a></li><li><a href="/blog-worklife/用户体验设计实战课">用户体验设计实战课</a></li><li><a href="/blog-worklife/程序员的个人财富课">程序员的个人财富课</a></li><li><a href="/blog-worklife/程序员进阶攻略">程序员进阶攻略</a></li><li><a href="/blog-worklife/讲好故事">讲好故事</a></li><li><a href="/blog-worklife/跟着高手学复盘">跟着高手学复盘</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-worklife/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>后端开发<ul><li><a href="/blog-worklife/大规模数据处理实战">大规模数据处理实战</a></li></ul></li><li>工作生活<ul><li><a href="/blog-worklife/10x程序员工作法">10x程序员工作法</a></li><li><a aria-current="page" class="active" href="/blog-worklife/python自动化办公实战课">python自动化办公实战课</a></li><li><a href="/blog-worklife/人人都用得上的写作课">人人都用得上的写作课</a></li><li><a href="/blog-worklife/体验设计案例课">体验设计案例课</a></li><li><a href="/blog-worklife/基于人因的用户体验设计课">基于人因的用户体验设计课</a></li><li><a href="/blog-worklife/打造爆款短视频">打造爆款短视频</a></li><li><a href="/blog-worklife/用户体验设计实战课">用户体验设计实战课</a></li><li><a href="/blog-worklife/程序员的个人财富课">程序员的个人财富课</a></li><li><a href="/blog-worklife/程序员进阶攻略">程序员进阶攻略</a></li><li><a href="/blog-worklife/讲好故事">讲好故事</a></li><li><a href="/blog-worklife/跟着高手学复盘">跟着高手学复盘</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-worklife/python自动化办公实战课">python自动化办公实战课</a></li><li><a href="/blog-worklife/python自动化办公实战课/01.课前必读">01.课前必读</a><ul><li><a href="/blog-worklife/python自动化办公实战课/01.课前必读/01"><span>开篇词 | 重复工作这么多，怎样才能提高工作效率？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/01.课前必读/02"><span>导读｜入门Python的必备知识</span></a></li></ul></li><li><a href="/blog-worklife/python自动化办公实战课/02.“输入”模块不同文件类型的批量合并和拆分问题">02.“输入”模块不同文件类型的批量合并和拆分问题</a><ul><li><a href="/blog-worklife/python自动化办公实战课/02.“输入”模块不同文件类型的批量合并和拆分问题/01"><span>01 | 拆分与合并：如何快速地批量处理内容相似的Excel？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/02.“输入”模块不同文件类型的批量合并和拆分问题/02"><span>02｜善用Python扩展库：如何批量合并多个文档？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/02.“输入”模块不同文件类型的批量合并和拆分问题/03"><span>03｜图片转文字：如何提高识别准确率？</span></a></li></ul></li><li><a href="/blog-worklife/python自动化办公实战课/03.春节特别放送">03.春节特别放送</a><ul><li><a href="/blog-worklife/python自动化办公实战课/03.春节特别放送/01"><span>春节特别放送1｜实体水果店转线上销售的数据统计问题</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/03.春节特别放送/02"><span>春节特别放送2｜用自顶至底的思路解决数据统计问题</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/03.春节特别放送/03"><span>春节特别放送3｜揭晓项目作业的答案</span></a></li></ul></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能">04.“运算”模块扩展常用的统计、搜索和排序功能</a><ul><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/01"><span>04 |  函数与字典：如何实现多次替换</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/02"><span>05 | 图像处理库：如何实现长图拼接？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/03"><span>06 | jieba分词：如何基于感情色彩进行单词数量统计？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/04"><span>07｜快速读写文件：如何实现跨文件的字数统计？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/05"><span>08｜正则表达式：如何提高搜索内容的精确度？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/06"><span>09｜扩展搜索：如何快速找到想要的文件？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/07"><span>10｜按指定顺序给词语排序，提高查找效率</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/04.“运算”模块扩展常用的统计、搜索和排序功能/08"><span>11 ｜通过程序并行计算，避免CPU资源浪费</span></a></li></ul></li><li><a href="/blog-worklife/python自动化办公实战课/05.“控制”模块增强办公软件及周边软硬件的交互能力">05.“控制”模块增强办公软件及周边软硬件的交互能力</a><ul><li><a href="/blog-worklife/python自动化办公实战课/05.“控制”模块增强办公软件及周边软硬件的交互能力/01"><span>12｜文本处理函数：三招解决数据对齐问题</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/05.“控制”模块增强办公软件及周边软硬件的交互能力/02"><span>13｜Excel插件：如何扩展Excel的基本功能？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/05.“控制”模块增强办公软件及周边软硬件的交互能力/03"><span>14｜VBA脚本编程：如何扩展Excel，实现文件的批量打印？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/05.“控制”模块增强办公软件及周边软硬件的交互能力/04"><span>15｜PowerShell脚本：如何实现文件批量处理的自动化？</span></a></li></ul></li><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作">06.“存储”模块和文件相关的常用操作</a><ul><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作/01"><span>16｜循环与文件目录管理：如何实现文件的批量重命名？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作/02"><span>17｜不同操作系统下，如何通过网络同步文件？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作/03"><span>18｜http库：如何批量下载在线内容，解放鼠标（上）？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作/04"><span>19｜http库：如何批量下载在线内容，解放鼠标（下）？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作/05"><span>20｜不同文件混在一起，怎么快速分类？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作/06"><span>21｜SQLite文本数据库：如何进行数据管理（上）？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/06.“存储”模块和文件相关的常用操作/07"><span>22｜SQLite文本数据库：如何进行数据管理（下）？</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果">07.“输出”模块智能化输出自己的工作成果</a><ul><li><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/01"><span>23｜怎么用数据透视表更直观地展示汇报成果？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/02"><span>24｜条形、饼状、柱状图最适合用在什么场景下？</span></a></li><li><a aria-current="page" class="active" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03"><span>25｜图表库：想要生成动态图表，用Echarts就够了</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/04"><span>26｜快速提取图片中的色块，模仿一张大师的照片</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/05"><span>27｜zipfile压缩库：如何给数据压缩&amp;加密备份？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/06"><span>28｜Celery库：让计算机定时执行任务，解放人力</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/07"><span>29｜网络和邮件库：定时收发邮件，减少手动操作</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/08"><span>30｜怎么快速把任意文件格式转成PDF，并批量加水印？</span></a></li></ul></li><li><a href="/blog-worklife/python自动化办公实战课/08.结束语">08.结束语</a><ul><li><a href="/blog-worklife/python自动化办公实战课/08.结束语/01"><span>结课测试题｜这些Python自动化办公的知识你都掌握了吗？</span></a></li><li><a href="/blog-worklife/python自动化办公实战课/08.结束语/02"><span>结束语｜和我一起成为10X效率职场人</span></a></li></ul></li><li><a href="/blog-worklife/python自动化办公实战课/summary">python自动化办公实战课</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="安装：使用pip安装pyecharts" data-depth="2"><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#安装使用pip安装pyecharts"><span>安装：使用pip安装pyecharts</span></a></li><li title="数据：为pyecharts加载数据" data-depth="2"><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#数据为pyecharts加载数据"><span>数据：为pyecharts加载数据</span></a></li><li title="确认数据的格式和来源" data-depth="3"><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#确认数据的格式和来源"><span>确认数据的格式和来源</span></a></li><li title="调整数据格式" data-depth="3"><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#调整数据格式"><span>调整数据格式</span></a></li><li title="绘图：使用pyecharts绘制动态图表" data-depth="2"><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#绘图使用pyecharts绘制动态图表"><span>绘图：使用pyecharts绘制动态图表</span></a></li><li title="小结" data-depth="2"><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#小结"><span>小结</span></a></li><li title="思考题" data-depth="2"><a href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="25图表库想要生成动态图表用echarts就够了"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#25图表库想要生成动态图表用echarts就够了"><span class="icon icon-link"></span></a>25｜图表库：想要生成动态图表，用Echarts就够了</h1><p>你好，我是尹会生。</p><p>在上一讲中，我们学习了怎么使用Seaborn来生成图片格式的图表。事实上，图片格式的图表也被称作静态图表，它能通过数据来更直观地展示结果。</p><p>不过很多时候，我们不仅要通过图片直观地展示数据，还要让图片容纳更多种类、更丰富的数据信息。这个时候，静态图表能展示的结果就十分有限了。比如你希望能给领导和同事在会议上演示数据的分析结果时，需要通过一张图来容纳更多的数据。</p><p>别担心，这时候我们可以<strong>采用动态图表的方法，来增强图片的表现力</strong>。因为动态图表展示的结果，相当于静态图表和数据这两者的混合，所以容纳的内容信息也就更丰富。</p><p>举个例子，我希望用一张图片来展示全国新冠确诊病例的分布。如果采用动态图，我就可以把鼠标移动到我需要查看的省份上面，显示该地区的确诊人数等相关信息。</p><p>就像下面这张截图一样。这张分布图不但基于颜色深浅显示了确诊人数的变化，还能通过鼠标悬停来显示具体的数据。使用起来是不是很方便？</p><p><img src="/blog-worklife/static/httpsstatic001geekbangorgresourceimage60016063f764e3493cb69b2922b1988dcf01.139d1dae.png" alt=""/></p><p>这张动态图表是使用HTML网页文件格式来展示的。同时，它也采用了Python的库pyecharts进行了绘制，其中的图形、数据都可以基于你的需要进行调整。最重要的是，绘制这样一张图片，操作起来和seaborn生成静态图表一样简单。</p><p>那接下来，我就为你具体讲解一下<strong>怎么<strong><strong>使用pyecharts来</strong></strong>绘制疫情实时地图</strong>，并以此为例，让你掌握<strong>怎么通过<strong><strong>pyecharts来</strong></strong>绘制其他的动态图</strong>。</p><p>要想<strong>使用pyecharts绘制动态图，必须要先对它进行安装，再为pyecharts加载数据，最后才能进行绘制动态图</strong>。所以我们参考静态图表的学习方法，我来先带你从安装开始学习pyecharts。</p><h2 id="安装使用pip安装pyecharts"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#安装使用pip安装pyecharts"><span class="icon icon-link"></span></a>安装：使用pip安装pyecharts</h2><p>pyecharts库和它的安装包同名，因此你依旧可以使用pip命令进行安装。不过在这一步，我们需要验证pyecharts库是否被成功安装。这是非常重要的一步。</p><p>因为和之前安装的软件包最大的不同是，pyecharts库的依赖包非常多。这里我要对依赖包的概念多做些补充。</p><p>依赖包是指软件为了支持某些功能，而这一功能刚好有其他的第三方库已经实现了，那么该软件就不必再次编写该功能。但是你在使用pyecharts库时，它所依赖的库也必须被安装在你的电脑上面，你才能正常使用它。</p><p>这就像你操作Excel在你的脚本使用了“xlwt”库，而其他人使用你的脚本，必须也在他的电脑上安装这个库是相同的道理。因此当你对pyecharts进行安装的时候，会有很多被依赖的安装包一起被安装在你的电脑上。不过不用担心，依赖包并不影响pyecharts库的安装。</p><p>由于安装pyecharts的过程，pip命令需要同时安装很多依赖包，你大概率还会在安装过程看到“Requirement already satisfied”这样的提示，这个提示是指你安装的库已经被安装在你的计算机中，有可能是你之前使用pip命令安装的这些被依赖的包，也有可能是因为其他库的依赖，它们被安装到了你的计算机中，但是这些提示都不影响pyecharts库的安装。这些提示也并非安装错误，你可以直接忽略该提示即可。</p><p>不过依赖包过多，虽然不影响安装，但是会带来一个主要的问题。那就是在安装的终端界面，会显示很多提示信息，如果提示信息超过一个屏幕的长度，会把安装成功或失败的安装结果覆盖掉，导致你很难确认pyecharts是否安装成功，因此我们需要一种可以确认pyecharts乃至任何一个第三方库是否被成功安装在当前计算机的方法。</p><p>想要验证pyecharts库是否被成功安装，可以在命令行执行下面这个命令，来帮助你验证：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">SHELL$ pip3 freeze | grep pyecharts</span></div><div class="token-line"><span class="token plain">    pyecharts==1.9.0</span></div></pre></div><p>在这条命令中，有三个地方需要你格外注意：</p><ul><li>命令中的“freeze”，用于查看pip命令在当前计算机安装的所有软件包都有哪些；</li><li>“|”叫做管道符，用于连接左右两条命令，并把左边命令的执行结果作为右边命令的输出；</li><li>通过grep命令，过滤只包含“pyecharts”的一行。如果你不使用grep命令，“pip3 freeze”会将当前计算机中所有的第三方库及其版本显示在终端上，如果第三方库非常多，很难手动确认pyecharts是否被成功安装了。</li></ul><p>这就是查看某一个库是否被成功安装在当前计算机，以及查看被安装版本的命令，我经常使用这一命令来确认依赖关系较多的库是否被成功安装。</p><p>不过你肯定会有疑问了，查看库是否安装这一做法是为了避免有些库存在不兼容，导致安装失败。那为什么还要查看安装的版本呢？</p><p>主要是考虑到版本兼容问题。我以pyecharts举例，pyecharts是Python和Echarts的结合体（Echarts是由百度开源的交互式可视化图表工具，基于JavaScript脚本实现）。因此Python提供的接口更新和Echarts工具更新，都会导致使用pyecharts的函数不同。而pyecharts 分为 v0.5.X 和 v1 两个大版本，且v0.5.X 和 v1 不兼容，v1 又是一个全新的版本，这两个版本支持的Python最低版本也不同。简而言之：</p><ul><li>v0.5.X 版本的pyecharts能支持Python2.7、Python3.4及以上版本；</li><li>v1 版本的pyecharts能支持Python3.6及以上版本。</li></ul><p>如果基于公司规定，你必须使用默认的Python3.4版本的话，可以使用如下命令安装0.5版本的pyecharts：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">pip install pyecharts==0.5</span></div></pre></div><p>解决完pyecharts的版本兼容问题后，相信你的pyecharts的正常运行肯定不在话下了，那接下来我就带你学习怎么给pyecharts加载数据。</p><h2 id="数据为pyecharts加载数据"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#数据为pyecharts加载数据"><span class="icon icon-link"></span></a>数据：为pyecharts加载数据</h2><p>在给pyecharts加载数据前，我们还要确认<strong>数据的格式和数据来源</strong>。这样做是为了把从网站中得到的数据转换为符合pyecharts绘图的数据。</p><ul><li>数据格式，用于传入数据前要把来源数据转换成被pyecharts支持的格式；</li><li>数据来源，决定数据的准确性和详细程度。</li></ul><p>例如网站中的数据包含了省、市、区的确诊人数，以及成功被治愈的人数，而我们只需要每个省被确诊的人数。因此数据格式和来源都需要经过你的精心处理，才能被pyecharts展示给使用者。</p><h3 id="确认数据的格式和来源"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#确认数据的格式和来源"><span class="icon icon-link"></span></a>确认数据的格式和来源</h3><p>pyecharts的<strong>数据格式</strong>，要基于不同的图形类型，使用不同的格式。但是一般情况下，是多行多列组成的类似Excel表格的格式，这种格式在Python中一般使用<strong>嵌套元组</strong>的形式进行保存。</p><p>以绘制疫情地图数据为例，我们需要每个省的名称以及现有确诊人数，那么我们可以把省的名称和人数放在一个元组中，并把多个省的数据再组成一个更大的元组，作为pyecharts的源数据。</p><p>这种并列数据，你可能第一时间想到的不是元组，而是列表，但是我要告诉你的是，列表的查询效率要远远低于元组。为了让你的图形在展示数据时能够更加流畅，我更建议你使用元组，具体方法是在把列表作为源数据使用前，使用“tuple()”函数把列表类型转换为元组。</p><p>确定数据格式之后，我们还需要一个<strong>数据来源</strong>，为了确保数据的准确性和实时性，我们得从腾讯新闻的网站引入外部数据，<a target="_blank" rel="noopener noreferrer" href="https://view.inews.qq.com/g2/getOnsInfo?name=disease_h5">数据地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的链接我先贴出来，接下来我再给你讲解一下怎么得到数据地址。</p><p>为了得到数据的地址，我分析了网站加载数据的过程，找到了数据接口的地址。这个分析方法你学会以后，也可以应用到其他需要抓取网页数据的工作中。我把抓取的步骤分成四步，分别是开启浏览器调试、请求网页、确认接口和确认返回数据。</p><p>先看第一步，<strong>开启浏览器调试</strong>。这一步骤是为了在请求过程中，能记录网页都请求了哪些数据接口。</p><p>以Chrome浏览器为例，使用快捷键F12可以打开调试模式，把选项卡调整至“Network”，调整后就进入接口的监听状态了。</p><p>第二步，<strong>请求网页</strong>。以腾讯疫情实时网页为例，可以在地址栏输入“<a target="_blank" rel="noopener noreferrer" href="https://news.qq.com/zt2020/page/feiyan.htm#/">https://news.qq.com/zt2020/page/feiyan.htm#/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>”，输入后，调试界面会显示该网页都请求了哪些地址。我把调试页面放在下方供你参考。</p><p><img src="/blog-worklife/static/httpsstatic001geekbangorgresourceimagec744c7349yyae70d9bcf369e95644fe4f344.0a6454e3.png" alt=""/></p><p>截图的左侧就是请求的所有数据接口的地址，从最开始请求的地址向下找，除了JS、JPG等网页图片和样式数据外，其他的请求接口就是我们要重点查看的接口。</p><p>第三步，<strong>确认接</strong>**。**由于网页中包含了多次从“getOnsInfo”接口取得数据，所以要逐个查看接口的返回数据。你可以通过鼠标点击接口的链接，然后再点击“Response”按钮，最后根据返回接口的返回内容，查看是否为“疫情实时数据”。</p><p>第四部，<strong>确认返回数据</strong>。当你从接口初步确认了该数据是“疫情实时数据”后，可以把该地址复制到浏览器中，进行访问。访问的具体办法就是通过模拟网页请求接口，这样就可以得到以下数据了。我将数据放在截图中，供你参考。</p><p><img src="/blog-worklife/static/httpsstatic001geekbangorgresourceimage99e599040018387067600f77ae5d603e4fe5.287bdc96.png" alt=""/></p><p>截图中的数据，可以通过查找省份和数据来确认数据的正确性。如果数据不正确，你需要回到第二步，再重新找下一个接口。</p><h3 id="调整数据格式"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#调整数据格式"><span class="icon icon-link"></span></a>调整数据格式</h3><p>当你确认了数据格式和数据源之后，接下来就需要把数据源的格式转换为pyecharts需要的嵌套元组格式。</p><p>首先，我先来分析通过网页直接请求数据接口之后的格式，请求后，你会看到网页上面的格式类似于Python的多个字典嵌套在一起，这种格式被称作JSON格式。在Python中你可以通过“json”库去解析这种格式，并把它转换为Python中的字典。解析的方法如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import requests</span></div><div class="token-line"><span class="token plain">    import json</span></div><div class="token-line"><span class="token plain">    url = &#x27;https://view.inews.qq.com/g2/getOnsInfo?name=disease_h5&#x27;</span></div><div class="token-line"><span class="token plain">    data = requests.get(url)</span></div><div class="token-line"><span class="token plain">    alldata = json.loads(data.json()[&#x27;data&#x27;]</span></div></pre></div><p>在这段代码中，我使用了requests.get()方法获取了接口的内容，并使用json.loads()方法把接口的数据转换成了字典。由于所有的数据都在下标为“data”的字典中，通过“字典[&#x27;data&#x27;]”取得字典值的用法，把所有数据存放到alldata变量中。</p><p>接下来，要把alldata变量中的字典转换为嵌套元组形式，这个转换过程需要遍历字典，来取得省份名称和对应的确诊人数。不过为了保存多个省份，我们还需要使用一个新的列表来存储多个省份的数据。最后再把列表转换为元组，作为pyecharts的绘图数据使用。我们依次来看一下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">chinadata = []</span></div><div class="token-line"><span class="token plain">    for province in alldata[&#x27;areaTree&#x27;][0][&#x27;children&#x27;]:</span></div><div class="token-line"><span class="token plain">        provincedata = (</span></div><div class="token-line"><span class="token plain">            province[&#x27;name&#x27;],</span></div><div class="token-line"><span class="token plain">            province[&#x27;total&#x27;][&#x27;nowConfirm&#x27;]</span></div><div class="token-line"><span class="token plain">        )</span></div><div class="token-line"><span class="token plain">        chinadata.append(provincedata)</span></div></pre></div><p>在代码的第2行，我使用了for循环，从alldata字典的多层嵌套结构中取出省份和该省份的确诊、累计、新增等人数信息。</p><p>在代码的第3行，我使用了一个新的元组，provincedata变量只保存每次遍历时得到的省份和确诊人数。</p><p>在代码的第7行，我把每次遍历生成的元组增加到chinadata列表中。这个列表就是最终处理好的数据内容，可以把chinadata数据直接作为pyecharts的源数据来进行绘图。</p><p>这段代码比较简单，不过我还是有两个小的使用建议提供给你。</p><p>第一个是，我在代码的第3行定义了一个provincedata的元组，从代码的正确执行角度来说，这个变量可以不用定义，完全可以把元组直接写入到chinadata.append() 函数的参数中。</p><p>但是从方便阅读代码的角度来看，这样书写代码不利于理解，因为append()函数的参数中包含了较为复杂的类型。因此我建议你在某个函数的参数中，如果传入了多种数据类型时，不妨增加一个临时变量。</p><p>另一个小建议是，在数据量较多的时候，应当尽量把列表转换为元组，加快查询效率。例如：我在代码的第7行先使用了列表对象用来存储变化的数据，然后通过for循环迭代alldata变量修改chinadata列表。最后，直到chindata不再需要改变内容时，我立即使用了tuple()把chinadata列表强制转换为了元组，那么后续的查询操作就都可以使用元组了。</p><p>通过对数据的抓取、分析和处理，源数据的格式和内容就准备完成了。接下来我需要将源数据加载到pyecharts中，并指定图形的类型和样式。</p><h2 id="绘图使用pyecharts绘制动态图表"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#绘图使用pyecharts绘制动态图表"><span class="icon icon-link"></span></a>绘图：使用pyecharts绘制动态图表</h2><p>当你准备好数据源并处理格式之后，就可以进行绘图了，主要有三个步骤，分别是<strong>确定图表类型</strong>、<strong>加载数据和设置图表样式</strong>。那我们先来看看怎么确定图表类型。</p><p>和我们学习seaborn类似，你可以参考图例，也可以参考分类来学习pyecharts支持的动态图表。与seaborn不同的是，pyecharts的官方文档没有图例，不过不要忘了，pyecharts是基于Echarts编写的，因此图例可以参考<a target="_blank" rel="noopener noreferrer" href="https://echarts.apache.org/examples/en/index.html">Echarts的官方网站<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><p>Echarts的图表指定函数和pyecharts相同，找到你需要的图例函数之后，就可以拿到pyecharts中直接使用。</p><p>那针对老手的图表分类和API可以<a target="_blank" rel="noopener noreferrer" href="https://gallery.pyecharts.org/#/README">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a target="_blank" rel="noopener noreferrer" href="https://gallery.pyecharts.org/#/README">这个地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。以最常用的图表，折线图为例，你可以打开<a target="_blank" rel="noopener noreferrer" href="https://gallery.pyecharts.org/#/Line/temperature_change_line_chart">地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，其中会包括图表的完整调用代码、测试数据和图例，通过参考示例可以让你掌握更多类型的图表。折线图的截图如下：<br/><img src="/blog-worklife/static/httpsstatic001geekbangorgresourceimageb006b018bf7f0d7b34bfdce2c89fd8c8a006.d9940948.png" alt=""/><img src="/blog-worklife/static/httpsstatic001geekbangorgresourceimage066506926268b01a96be2aaedaa2720d2d65.a5231fd2.png" alt=""/></p><p>再让我们回到疫情地图的案例中，由于我们需要绘制中国地图，因此直接使用pyecharts库的Map()类，它是绘制动态地图的类。它的<a target="_blank" rel="noopener noreferrer" href="https://gallery.pyecharts.org/#/Map/map_base">官方网站<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>链接我贴在这里。</p><p>通过参考官方网站的案例代码，我们可知在将Map()类实例化之后，进行绘图时，调用了add()、set_global_opts()和render()三个方法，它们分别是增加数据、设置样式和渲染。我们来依次学习一下。</p><ul><li><p>add()方法用来为图表增加图表名称、加载数据、指定地图的区域，其中加载数据的参数我使用了tuple()函数，可以直接把列表转换为元组，这样在查找效率上会比列表更高。</p></li><li><p>set_global_opts()方法用来指定图表的样式和格式，这里我做了两个格式的调整操作，它们是：图表的标题和图表的颜色。图表的标题部分，我将“数据最后更新时间”作为图表的标题，是通过字典“alldata[&#x27;lastUpdateTime&#x27;]”实现的。图表的颜色是通过pieces参数实现的，根据不同省份确诊人数在什么数量范围，显示该省份的颜色深浅。颜色越深，表示当前周期采集到的确诊人数越多。</p></li><li><p>render()方法，用来指定图表保存的网页路径和名称。这里需要注意的是，add()和set_global_opts()方法如果出现错误并不会马上报错，只有在调用render()方法时才会出现错误。所以一旦出现错误，你应该从导入数据的格式、add()和set_global_opts()方法参数中检查。</p></li></ul><p>执行render()方法之后，动态图就会以网页的形式保存至“covid19_map.html”文件中，你可以在浏览器里查看，并通过鼠标移动展示不同省份确诊人数的具体信息。</p><p>最后，我把pyecharts绘制图形的完整代码贴在下方供你参考，你可以直接将代码复制到自己的计算机执行。</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import requests</span></div><div class="token-line"><span class="token plain">    import json</span></div><div class="token-line"><span class="token plain">    from pyecharts.charts import Map</span></div><div class="token-line"><span class="token plain">    from pyecharts import options as opts</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    url = &#x27;https://view.inews.qq.com/g2/getOnsInfo?name=disease_h5&#x27;</span></div><div class="token-line"><span class="token plain">    data = requests.get(url)</span></div><div class="token-line"><span class="token plain">    alldata = json.loads(data.json()[&#x27;data&#x27;])</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    chinadata = []</span></div><div class="token-line"><span class="token plain">    for province in alldata[&#x27;areaTree&#x27;][0][&#x27;children&#x27;]:</span></div><div class="token-line"><span class="token plain">        provincedata = (</span></div><div class="token-line"><span class="token plain">            province[&#x27;name&#x27;],</span></div><div class="token-line"><span class="token plain">            province[&#x27;total&#x27;][&#x27;nowConfirm&#x27;]</span></div><div class="token-line"><span class="token plain">        )</span></div><div class="token-line"><span class="token plain">        chinadata.append(provincedata)</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    map_chart = Map()</span></div><div class="token-line"><span class="token plain">    map_chart.add(</span></div><div class="token-line"><span class="token plain">            &quot;全国确诊病例分布图&quot;,</span></div><div class="token-line"><span class="token plain">            tuple(chinadata),</span></div><div class="token-line"><span class="token plain">            &quot;china&quot;,</span></div><div class="token-line"><span class="token plain">            is_map_symbol_show=False</span></div><div class="token-line"><span class="token plain">        )</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    map_chart.set_global_opts(</span></div><div class="token-line"><span class="token plain">        title_opts=opts.TitleOpts(</span></div><div class="token-line"><span class="token plain">            title=f&quot;全国疫情地图( {alldata[&#x27;lastUpdateTime&#x27;]} )&quot;),</span></div><div class="token-line"><span class="token plain">            visualmap_opts=opts.VisualMapOpts(</span></div><div class="token-line"><span class="token plain">                is_piecewise=True,</span></div><div class="token-line"><span class="token plain">                pieces=[</span></div><div class="token-line"><span class="token plain">                    {&quot;min&quot;: 1, &quot;max&quot;: 9, &quot;label&quot;: &quot;1-9人&quot;, &quot;color&quot;: &quot;#FFE6BE&quot;},</span></div><div class="token-line"><span class="token plain">                    {&quot;min&quot;: 10, &quot;max&quot;: 99, &quot;label&quot;: &quot;10-99人&quot;, &quot;color&quot;: &quot;#FFB769&quot;},</span></div><div class="token-line"><span class="token plain">                    {&quot;min&quot;: 100, &quot;max&quot;: 499, &quot;label&quot;: &quot;100-499人&quot;, &quot;color&quot;: &quot;#FF8F66&quot;},</span></div><div class="token-line"><span class="token plain">                    {&quot;min&quot;: 500, &quot;max&quot;: 999, &quot;label&quot;: &quot;500-999人&quot;, &quot;color&quot;: &quot;#ED514E&quot;},</span></div><div class="token-line"><span class="token plain">                    {&quot;min&quot;: 1000, &quot;max&quot;: 9999, &quot;label&quot;: &quot;1000-9999人&quot;, &quot;color&quot;: &quot;#CA0D11&quot;},</span></div><div class="token-line"><span class="token plain">                    {&quot;min&quot;: 10000, &quot;max&quot;: 100000, &quot;label&quot;: &quot;10000人以上&quot;, &quot;color&quot;: &quot;#A52A2A&quot;}</span></div><div class="token-line"><span class="token plain">                ]))</span></div><div class="token-line"><span class="token plain">    </span></div><div class="token-line"><span class="token plain">    map_chart.render(&#x27;covid19_map.html&#x27;)</span></div></pre></div><h2 id="小结"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#小结"><span class="icon icon-link"></span></a>小结</h2><p>今天的主要内容就这么多，我来为你最后总结一下本讲的主要内容。</p><p>在本讲中，我通过pyecharts展示了疫情实时信息的动态图表，并为你介绍了图表的制作方法。对比静态图表，动态图表的制作方法要复杂，但是一张图能容纳的信息也要比静态图表多，你需要根据自己的工作场景合理的选择图表种类。</p><p>同时，你还会发现，图表的绘制难点在数据格式的处理上，通过网络采集数据往往要经过从JSON格式到字典再到元组的嵌套；图表绘制过程可以重复利于的部分就是图表的创建过程，包括数据添加、样式设置和渲染。掌握这些通用的使用原则，可让让你从熟练的操作中，加快自动办公的效率。</p><p>而你掌握的图表越丰富，在进行工作汇报和演示时，能够通过图形表达的信息就越清晰。这是我建议你能够掌握更多图表类型的原因。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog-worklife/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03#思考题"><span class="icon icon-link"></span></a>思考题</h2><p>今天的思考题是个开放的问题，在你使用pyecharts绘制的图表需要每天更新时，如何自动删除上一个生成的文件？那有没有办法让网页自动更新呢？</p><p>欢迎你把思考和想法分享在留言区，我们一起交流讨论。如果今天的内容对你展示工作成果有帮助，也欢迎你把课程分享给你的同事和朋友，我们一起做职场上的效率人。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/python自动化办公实战课/07.“输出”模块智能化输出自己的工作成果/03.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/29 14:28:22</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-worklife/umi.4ad44284.js"></script>
  </body>
</html>
